
# Complex Pipeline

Moving towards to a more complex pipeline: pipelining becomes complex when we want high performance in the presence of:

* Long latency or partially pipelined **floating-point units**
* **Multiple** function and memory **units**
* Memory systems with **variable access time**
* Precise **exception** (divisions by zero, underflow and overflow at hardware level)

![](images/da6e4fe025bf2600434ae883da7d909e.png)

General purpose registers (**GPRs**) contain information being manipulated by the user program currently running. Floating-point registers (**FPRs**) hold numeric values associated with some exponent.
Example of **complex pipeline** with floating point functional units:

![](images/75ec3499ad22dee9bf1921918f0ce2fe.png)

**Main feature of Complex Pipeline: 

- ISSUE stage can be seen as an infinite buffer.
- An instruction enters the ISSUE if it does not cause a WAR or WAW hazard.
- RAW can enter in the ISSUE buffer and will be solved waiting  
- All functional units are pipelined
- Generally it's assumed that the WB unit has a single write port
- RF can write first half of the CC and Read in the second half.
- Instructions are fetched, decoded and issued in order (always in this course)
- Only one instruction can be issued at a time, and in the case multiple instructions are ready, the oldest one will go first

|    Instruction    | C1  | C2  | C3  |C4 | C5  | C6  | C7  | C8  | C9  | C10 | C11 | C12 |     
|:-----------------:|:---:|:---:|:---:|:----:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|  `LD F1, O(R1)`   |  F  |  D  | is  | E1 | E2  | E3  | WB  |     |     |     |     |     
|  `LD F2, O(R1)`   |  -  |  F  |  D  |  is  | E1  | E2  | E3  | WB  |     |     |     |       |
| `ADDD F1, F1, F2` |     | 1 |  F  |  D   | So  | So  | So  | 15  | E1  | E2  | E3  |  WB  |
|  `ADD R1, R1, 8`  |     |     |     | F  | SF  | SF  | SF  |  D  | is  |  E  | WB  |  .   |




